<html lang="en"><head>
    <title>Project Futures Exchange Shanghai Page</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/d3-path.v2.min.js"></script>
    <script src="https://d3js.org/d3-shape.v2.min.js"></script>
    <script src="https://d3js.org/topojson.v1.min.js"></script>
    <script src="https://d3js.org/d3-array.v2.min.js"></script>
    <script src="https://d3js.org/d3-geo.v2.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v3.min.js"></script>
    <script src="https://unpkg.com/react/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone/babel.js"></script>
    <link rel="stylesheet" href="styles.css"> 
    <style>
        body {
          background-color:rgb(53, 50, 50);
        }
    </style>
<script>"use strict";

var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var WIDTH = 1800;
var HEIGHT = 1000;
var margin = { top: 20, right: 40, bottom: 20, left: 40 };
var csvUrl = 'futures_data.csv';

function useData(csvPath) {
var _React$useState = React.useState(null),
    _React$useState2 = _slicedToArray(_React$useState, 2),
    dataAll = _React$useState2[0],
    setData = _React$useState2[1];

React.useEffect(function () {
    d3.csv(csvPath).then(function (data) {
        data.forEach(function (d) {
            d.index = +d.index;
            d.volume = +Math.floor(d.volume / 100000);
            d.tradingvolume = +Math.floor(d.tradingvolume / 1000);
            d.Sharpe = +d.Sharpe;
        });
        setData(data);
    });
}, []);
return dataAll;
}

function TreeMapText(props) {
var d = props.d,
    sty = props.sty;

var result = d.ancestors().reverse().slice(1).map(function (d, idx) {
    return d.data.name;
}).join("\n") + "\nSharpe:" + d3.format("")(d.value);
var result_list = result.split("\n");
if (result_list[0] == 'DCE') {
    var exchange = "Dalian Commodity Exchange";
} else if (result_list[0] == 'CFFEX') {
    var exchange = "China Financial Futures Exchange";
} else if (result_list[0] == 'SHFE') {
    var exchange = "Shanghai Futures Exchange";
} else if (result_list[0] == 'CZCE') {
    var exchange = "Zhengzhou Commodity Exchange";
} else {
    var exchange = "Shanghai Energy Exchange";
}
if (sty == 0) {
    return React.createElement(
        "foreignObject",
        { width: d.x1 - d.x0, height: d.y1 - d.y0 },
        React.createElement(
            "div",
            null,
            React.createElement(
                "p",
                null,
                "Date: ",
                result_list[4].slice(-2) + '\n',
                "Volume: ",
                result_list[1] + '\n',
                "Trading vol: ",
                result_list[3] + '\n',
                "Sharpe: ",
                result_list[2].slice(0, 3) + '\n',
                "Exchange: ",
                exchange
            )
        )
    );
} else {
    return React.createElement(
        "foreignObject",
        { width: (d.x1 - d.x0) * 2, height: (d.y1 - d.y0) * 2 },
        React.createElement(
            "div",
            null,
            React.createElement(
                "h2",
                null,
                "Date: ",
                result_list[4].slice(-2) + '\n',
                "Volume: ",
                result_list[1] + '\n',
                "Trading vol: ",
                result_list[3] + '\n',
                "Sharpe: ",
                result_list[2].slice(0, 3) + '\n',
                "Exchange: ",
                exchange
            )
        )
    );
}
}

function TreeMap(props) {
var width = props.width,
    height = props.height,
    data = props.data,
    first = props.first,
    second = props.second,
    selectedCell = props.selectedCell,
    setSelectedCell = props.setSelectedCell;

var margin = { top: 20, right: 40, bottom: 20, left: 40, gap: 40 };
var innerWidth = width - margin.left - margin.right;
var innerHeight = height - margin.top - margin.bottom;

var attributes = ["Exchange", "volume", "Sharpe", 'tradingvolume', 'ym'];

var root = { name: "root", children: buildTree(data, attributes, first, second), value: 10 };

root = d3.hierarchy(root).sum(function (d) {
    // console.log(d.children ? 0 : d.value);
    return d.children ? 0 : d.value;
});

var tree = d3.treemap().tile(d3.treemapSquarify).size([innerWidth, innerHeight]).padding(2).round(true)(root).sort(function (a, b) {
    return b.value - a.value;
});;

if (second == 0) {
    var parents = tree.leaves().map(function (d) {
        return d.parent.data.group[0]['ym'];
    });
    var attr2 = 'ym';
} else {
    var parents = tree.leaves().map(function (d) {
        return d.parent.data.group[0]['Exchange'];
    });
    var attr2 = 'Exchange';
}

var parentsCategories = parents.filter(function (d, idx) {
    return parents.indexOf(d) === idx;
});

var color = d3.scaleOrdinal(d3.schemePaired).domain(parentsCategories);

var firstLayer = tree.descendants()[0].children;

var mouseOver = function mouseOver(d) {
    setSelectedCell(d);
};

var mouseOut = function mouseOut() {
    setSelectedCell(null);
};
var lefts = tree.leaves().length;
var final = tree.leaves()[lefts - 1];

return React.createElement(
    "g",
    { transform: "translate(" + margin.left + ", " + margin.right + ")" },
    React.createElement(
        "svg",
        { width: width, height: height },
        firstLayer.map(function (d, idx) {

            return React.createElement(
                "g",
                { key: idx + "outerline", transform: "translate(" + d.x0 + ", " + d.y0 + ")" },
                React.createElement("rect", { width: d.x1 - d.x0, height: d.y1 - d.y0, stroke: "white", fill: "none" }),
                React.createElement(
                    "text",
                    { style: { fontSize: "6em", fill: 'White' }, x: (d.x1 - d.x0) / 2, y: (d.y1 - d.y0) / 2, textAnchor: "middle",
                        transform: "rotate(" + (d.x1 - d.x0 > d.y1 - d.y0 ? 0 : 90) + ", " + (d.x1 - d.x0) / 2 + ", " + (d.y1 - d.y0) / 2 + ")" },
                    d.data.name
                )
            );
        }),
        tree.leaves().map(function (d, idx) {
            var info = d;

            if (selectedCell) {
                var gd = selectedCell.value;
                var ind = selectedCell;
            } else {
                var gd = null;
            }
            if (ind) {
                if (ind.data.group[0]['Exchange'] == "SHFE") {
                    var page_info = "Shanghai.html";
                } else if (ind.data.group[0]['Exchange'] == "DCE") {
                    var page_info = "DCE.html";
                } else if (ind.data.group[0]['Exchange'] == "CZCE") {
                    var page_info = "CZCE.html";
                } else if (ind.data.group[0]['Exchange'] == "CFFEX") {
                    var page_info = "CFFEX.html";
                } else {
                    var page_info = "INE.html";
                }
                var date = ind.data.group[0]['ym'] + '=' + ind.data.group[0]['Exchange'];
            }

            if (final.value == d.value) {
                if (!ind) {
                    return React.createElement(
                        "g",
                        { key: idx + "treemap", transform: "translate(" + d.x0 + ", " + d.y0 + ")",
                            onMouseOver: function onMouseOver() {
                                return mouseOver(d);
                            } },
                        React.createElement("rect", { width: d.x1 - d.x0, height: d.y1 - d.y0, stroke: "none",
                            fill: color(d.parent.data.group[0][attr2]),
                            opacity: 0.6 }),
                        React.createElement(TreeMapText, { d: d, sty: 0 })
                    );
                } else {
                    return React.createElement(
                        "g",
                        null,
                        React.createElement(
                            "g",
                            { key: idx + "treemap", transform: "translate(" + d.x0 + ", " + d.y0 + ")",
                                onMouseOver: function onMouseOver() {
                                    return mouseOver(d);
                                } },
                            React.createElement("rect", { width: d.x1 - d.x0, height: d.y1 - d.y0, stroke: "none",
                                fill: color(d.parent.data.group[0][attr2]), opacity: 0.9 }),
                            React.createElement(TreeMapText, { d: d, sty: 0 })
                        ),
                        React.createElement(
                            "a",
                            { href: page_info + '?id=' + date },
                            React.createElement(
                                "g",
                                { transform: "translate(" + ind.x0 + ", " + ind.y0 + ")",
                                    onMouseOver: function onMouseOver() {
                                        return mouseOver(ind);
                                    }, onMouseOut: mouseOut },
                                React.createElement("rect", { width: (ind.x1 - ind.x0) * 2, height: (ind.y1 - ind.y0) * 2, stroke: "none",
                                    fill: color(ind.parent.data.group[0][attr2])
                                }),
                                React.createElement(TreeMapText, { d: ind, sty: 1 })
                            )
                        )
                    );
                }
            } else {
                return React.createElement(
                    "g",
                    { key: idx + "treemap", transform: "translate(" + d.x0 + ", " + d.y0 + ")",
                        onMouseOver: function onMouseOver() {
                            return mouseOver(d);
                        } },
                    React.createElement("rect", { width: d.x1 - d.x0, height: d.y1 - d.y0, stroke: "none",
                        fill: color(d.parent.data.group[0][attr2]), opacity: 0.9 }),
                    React.createElement(TreeMapText, { d: d, sty: 0 })
                );
            }
        })
    )
);
}

function buildTree(data, attributes, first, second) {
var itemArr = [];
if (attributes.length === 0) {
    return null;
}
var groups = d3.groups(data, function (d) {
    return d[attributes[second]];
});
var levels = groups.map(function (d) {
    return d[0];
});

for (var i = 0; i < levels.length; i++) {
    var volume_size = groups[i][1].filter(function (d) {
        return d.volume;
    }) / groups[i][1].length;
    itemArr.push({ name: levels[i], children: buildTree(groups[i][1], attributes.slice(1), first, 0),
        value: groups[i][1][0][first], group: groups[i][1] });
}
return itemArr;
}

function Dropdown(props) {
var options = props.options,
    selectedValue = props.selectedValue,
    onSelectedValueChange = props.onSelectedValueChange;


return React.createElement(
    "div",
    { "class": "select" },
    React.createElement(
        "select",
        { defaultValue: selectedValue, onChange: function onChange(event) {
                onSelectedValueChange(event.target.value);
            } },
        options.map(function (_ref) {
            var value = _ref.value,
                label = _ref.label;

            return React.createElement(
                "option",
                { key: label, value: value },
                label
            );
        })
    )
);
}

var Home_page = function Home_page() {
var _React$useState3 = React.useState("Sharpe"),
    _React$useState4 = _slicedToArray(_React$useState3, 2),
    firstAttr = _React$useState4[0],
    setFirstAttr = _React$useState4[1];

var _React$useState5 = React.useState(0),
    _React$useState6 = _slicedToArray(_React$useState5, 2),
    secondAttr = _React$useState6[0],
    setSecondAttr = _React$useState6[1];

var _React$useState7 = React.useState('1'),
    _React$useState8 = _slicedToArray(_React$useState7, 2),
    year = _React$useState8[0],
    setYear = _React$useState8[1];

var _React$useState9 = React.useState(null),
    _React$useState10 = _slicedToArray(_React$useState9, 2),
    selectedCell = _React$useState10[0],
    setSelectedCell = _React$useState10[1];

var selected = 'Sharpe';
var dataAll = useData(csvUrl);
var YEAR = ['2017', '2018', '2019', '2020'];
if (!dataAll) {
    return React.createElement(
        "p",
        null,
        "Loading..."
    );
}

var data = dataAll.filter(function (d) {
    return d.ym.slice(0, 4) == YEAR[year];
});
var onFristAttrChange = function onFristAttrChange(attr) {
    setFirstAttr(attr);
};
var onSecondAttrChange = function onSecondAttrChange(attr) {
    setSecondAttr(attr);
};
var changeHandlerYear = function changeHandlerYear(event) {
    setYear(event.target.value);
};

var options = [{ value: "volume", label: "Volume" }, { value: "Sharpe", label: "Sharpe" }, { value: "tradingvolume", label: "Trading Volume" }];
var options2 = [{ value: 4, label: "Date" }, { value: 0, label: "Exchange" }];

return React.createElement(
    "div",
    null,
    React.createElement(
        "div",
        null,
        React.createElement(
            "a",
            { href: "index.html", fill: "black" },
            React.createElement(
                "button",
                { "class": "button" },
                React.createElement(
                    "text",
                    { style: { textAnchor: 'bottom', fontSize: '2em' }, fill: "black", x: "0%", y: "0" },
                    "Capstone - Vizualization"
                )
            )
        ),
        React.createElement(
            "svg",
            { width: "100%", height: "1" },
            React.createElement("line", { x2: "100%", y1: "100%", y2: "100%", stroke: "White" })
        )
    ),
    React.createElement(
        "div",
        null,
        React.createElement(Dropdown, { options: options, selectedValue: firstAttr, onSelectedValueChange: onFristAttrChange }),
        React.createElement(Dropdown, { options: options2, selectedValue: secondAttr, onSelectedValueChange: onSecondAttrChange }),
        React.createElement("input", { key: "slider", type: "range", "class": "slider", list: "tickmarks", min: "0", max: "3", value: year, step: "1", onChange: changeHandlerYear }),
        React.createElement(
            "datalist",
            { id: "tickmarks" },
            React.createElement("option", { value: "0" }),
            React.createElement("option", { value: "1" }),
            React.createElement("option", { value: "2" }),
            React.createElement("option", { value: "3" })
        ),
        React.createElement("input", { key: "monthText", "class": "labelinput", type: "text", value: 'Year ' + YEAR[year], readOnly: true })
    ),
    React.createElement(
        "div",
        null,
        React.createElement("svg", { width: 150, height: 400, fill: "black" }),
        React.createElement(
            "g",
            { transform: "translate(" + 200 + ", " + 0 + ")" },
            React.createElement(TreeMap, { width: WIDTH, height: HEIGHT, data: data, first: firstAttr, second: secondAttr, selectedCell: selectedCell, setSelectedCell: setSelectedCell })
        )
    )
);
};

ReactDOM.render(React.createElement(Home_page, null), document.getElementById('root'));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIklubGluZSBCYWJlbCBzY3JpcHQiXSwibmFtZXMiOlsiV0lEVEgiLCJIRUlHSFQiLCJtYXJnaW4iLCJ0b3AiLCJyaWdodCIsImJvdHRvbSIsImxlZnQiLCJjc3ZVcmwiLCJ1c2VEYXRhIiwiY3N2UGF0aCIsIlJlYWN0IiwidXNlU3RhdGUiLCJkYXRhQWxsIiwic2V0RGF0YSIsInVzZUVmZmVjdCIsImQzIiwiY3N2IiwidGhlbiIsImRhdGEiLCJmb3JFYWNoIiwiZCIsImluZGV4Iiwidm9sdW1lIiwiTWF0aCIsImZsb29yIiwidHJhZGluZ3ZvbHVtZSIsIlNoYXJwZSIsIlRyZWVNYXBUZXh0IiwicHJvcHMiLCJzdHkiLCJyZXN1bHQiLCJhbmNlc3RvcnMiLCJyZXZlcnNlIiwic2xpY2UiLCJtYXAiLCJpZHgiLCJuYW1lIiwiam9pbiIsImZvcm1hdCIsInZhbHVlIiwicmVzdWx0X2xpc3QiLCJzcGxpdCIsImV4Y2hhbmdlIiwieDEiLCJ4MCIsInkxIiwieTAiLCJUcmVlTWFwIiwid2lkdGgiLCJoZWlnaHQiLCJmaXJzdCIsInNlY29uZCIsInNlbGVjdGVkQ2VsbCIsInNldFNlbGVjdGVkQ2VsbCIsImdhcCIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsImF0dHJpYnV0ZXMiLCJyb290IiwiY2hpbGRyZW4iLCJidWlsZFRyZWUiLCJoaWVyYXJjaHkiLCJzdW0iLCJ0cmVlIiwidHJlZW1hcCIsInRpbGUiLCJ0cmVlbWFwU3F1YXJpZnkiLCJzaXplIiwicGFkZGluZyIsInJvdW5kIiwic29ydCIsImEiLCJiIiwicGFyZW50cyIsImxlYXZlcyIsInBhcmVudCIsImdyb3VwIiwiYXR0cjIiLCJwYXJlbnRzQ2F0ZWdvcmllcyIsImZpbHRlciIsImluZGV4T2YiLCJjb2xvciIsInNjYWxlT3JkaW5hbCIsInNjaGVtZVBhaXJlZCIsImRvbWFpbiIsImZpcnN0TGF5ZXIiLCJkZXNjZW5kYW50cyIsIm1vdXNlT3ZlciIsIm1vdXNlT3V0IiwibGVmdHMiLCJsZW5ndGgiLCJmaW5hbCIsImZvbnRTaXplIiwiZmlsbCIsImluZm8iLCJnZCIsImluZCIsInBhZ2VfaW5mbyIsImRhdGUiLCJpdGVtQXJyIiwiZ3JvdXBzIiwibGV2ZWxzIiwiaSIsInZvbHVtZV9zaXplIiwicHVzaCIsIkRyb3Bkb3duIiwib3B0aW9ucyIsInNlbGVjdGVkVmFsdWUiLCJvblNlbGVjdGVkVmFsdWVDaGFuZ2UiLCJldmVudCIsInRhcmdldCIsImxhYmVsIiwiSG9tZV9wYWdlIiwiZmlyc3RBdHRyIiwic2V0Rmlyc3RBdHRyIiwic2Vjb25kQXR0ciIsInNldFNlY29uZEF0dHIiLCJ5ZWFyIiwic2V0WWVhciIsInNlbGVjdGVkIiwiWUVBUiIsInltIiwib25GcmlzdEF0dHJDaGFuZ2UiLCJhdHRyIiwib25TZWNvbmRBdHRyQ2hhbmdlIiwiY2hhbmdlSGFuZGxlclllYXIiLCJvcHRpb25zMiIsInRleHRBbmNob3IiLCJSZWFjdERPTSIsInJlbmRlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiXSwibWFwcGluZ3MiOiI7Ozs7QUFFWSxJQUFNQSxRQUFRLElBQWQ7QUFDQSxJQUFNQyxTQUFTLEdBQWY7QUFDQSxJQUFNQyxTQUFTLEVBQUVDLEtBQUssRUFBUCxFQUFXQyxPQUFPLEVBQWxCLEVBQXNCQyxRQUFRLEVBQTlCLEVBQWtDQyxNQUFNLEVBQXhDLEVBQWY7QUFDQSxJQUFNQyxTQUFTLDJJQUFmOztBQUVBLFNBQVNDLE9BQVQsQ0FBaUJDLE9BQWpCLEVBQXlCO0FBQUEsMEJBQ01DLE1BQU1DLFFBQU4sQ0FBZSxJQUFmLENBRE47QUFBQTtBQUFBLFFBQ2RDLE9BRGM7QUFBQSxRQUNMQyxPQURLOztBQUVyQkgsVUFBTUksU0FBTixDQUFnQixZQUFNO0FBQ2xCQyxXQUFHQyxHQUFILENBQU9QLE9BQVAsRUFBZ0JRLElBQWhCLENBQXFCLGdCQUFRO0FBQ3pCQyxpQkFBS0MsT0FBTCxDQUFhLGFBQUs7QUFDZEMsa0JBQUVDLEtBQUYsR0FBUyxDQUFFRCxFQUFFQyxLQUFiO0FBQ0FELGtCQUFFRSxN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RUFBbUYsT0FBT1AsSUFBMUYsRUFBaUcsTUFBSyxHQUF0RyxFQUEwRyxVQUFVUSxpQkFBcEgsR0FISjtBQUlRO0FBQUE7QUFBQSxrQkFBVSxJQUFHLFdBQWI7QUFDSSxnREFBUSxPQUFNLEdBQWQsR0FESjtBQUVJLGdEQUFRLE9BQU0sR0FBZCxHQUZKO0FBR0ksZ0RBQVEsT0FBTSxHQUFkLEdBSEo7QUFJSSxnREFBUSxPQUFNLEdBQWQ7QUFKSixhQUpSO0FBVUksMkNBQU8sS0FBSSxXQUFYLEVBQXVCLFNBQU0sWUFBN0IsRUFBMEMsTUFBSyxNQUEvQyxFQUFzRCxPQUFPLFVBQVFMLEtBQUtILElBQUwsQ0FBckUsRUFBaUYsY0FBakY7QUFWSixTQWZHO0FBNEJIO0FBQUE7QUFBQTtBQUNBLHlDQUFLLE9BQVEsR0FBYixFQUFrQixRQUFVLEdBQTVCLEVBQWlDLE1BQU8sT0FBeEMsR0FEQTtBQUdBO0FBQUE7QUFBQSxrQkFBRywwQkFBd0IsR0FBeEIsVUFBZ0MsQ0FBaEMsTUFBSDtBQUNBLG9DQUFDLE9BQUQsSUFBUyxPQUFPckgsS0FBaEIsRUFBdUIsUUFBUUMsTUFBL0IsRUFBdUMsTUFBUWlCLElBQS9DLEVBQXFELE9BQVMrRixTQUE5RCxFQUF5RSxRQUFVRSxVQUFuRixFQUErRixjQUFjL0QsWUFBN0csRUFBMkgsaUJBQWlCQyxlQUE1STtBQURBO0FBSEE7QUE1QkcsS0FBUDtBQW9DQyxDQW5FTDs7QUFxRUkyRSxTQUFTQyxNQUFULENBQWlCLG9CQUFDLFNBQUQsT0FBakIsRUFBK0JDLFNBQVNDLGNBQVQsQ0FBd0IsTUFBeEIsQ0FBL0IiLCJmaWxlIjoiSW5saW5lIEJhYmVsIHNjcmlwdCIsInNvdXJjZXNDb250ZW50IjpbIlxuXG4gICAgICAgICAgICBjb25zdCBXSURUSCA9IDEzMDA7XG4gICAgICAgICAgICBjb25zdCBIRUlHSFQgPSA4MDA7XG4gICAgICAgICAgICBjb25zdCBtYXJnaW4gPSB7IHRvcDogMjAsIHJpZ2h0OiA0MCwgYm90dG9tOiAyMCwgbGVmdDogNDAgfTtcbiAgICAgICAgICAgIGNvbnN0IGNzdlVybCA9ICdodHRwczovL2dpc3QuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1BhdHJpY2stQ0QvZGMyNWNlZTY5MzM1NjA3ZWQwYzhjN2Q2MDM0ZDY1MzYvcmF3LzA2MTdiMDAzNjdkY2FlYjU4ZDkyZTFlOTIyZGFiNGFkYzZmMjYyZjYvaG9tZV9kYXRhLmNzdic7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHVzZURhdGEoY3N2UGF0aCl7XG4gICAgICAgICAgICAgICAgY29uc3QgW2RhdGFBbGwsIHNldERhdGFdID0gUmVhY3QudXNlU3RhdGUobnVsbCk7XG4gICAgICAgICAgICAgICAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZDMuY3N2KGNzdlBhdGgpLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5pbmRleCA9KyBkLmluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQudm9sdW1lID0rIE1hdGguZmxvb3IoZC52b2x1bWUvMTAwMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnRyYWRpbmd2b2x1bWU9ICsgTWF0aC5mbG9vcihkLnRyYWRpbmd2b2x1bWUvMTAwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5TaGFycGU9ICtkLlNoYXJwZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldERhdGEoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sIFtdKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YUFsbDtcbiAgICAgICAgICAgIH1cbiAgICBcbiAgIFxuICAgICAgICAgICAgZnVuY3Rpb24gVHJlZU1hcFRleHQocHJvcHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7ZCwgc3R5fSA9IHByb3BzO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGQuYW5jZXN0b3JzKCkucmV2ZXJzZSgpLnNsaWNlKDEpLm1hcCgoZCwgaWR4KSA9PiBkLmRhdGEubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuam9pbihcIlxcblwiKStcIlxcblNoYXJwZTpcIitkMy5mb3JtYXQoXCJcIikoZC52YWx1ZSlcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHRfbGlzdCA9IHJlc3VsdC5zcGxpdChcIlxcblwiKTsgXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdF9saXN0WzBdPT0nRENFJykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXhjaGFuZ2UgPSBcIkRhbGlhbiBDb21tb2RpdHkgRXhjaGFuZ2VcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdF9saXN0WzBdPT0nQ0ZGRVgnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBleGNoYW5nZSA9IFwiQ2hpbmEgRmluYW5jaWFsIEZ1dHVyZXMgRXhjaGFuZ2VcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdF9saXN0WzBdPT0nU0hGRScpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4Y2hhbmdlID0gXCJTaGFuZ2hhaSBGdXR1cmVzIEV4Y2hhbmdlXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHRfbGlzdFswXT09J0NaQ0UnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBleGNoYW5nZSA9IFwiWmhlbmd6aG91IENvbW1vZGl0eSBFeGNoYW5nZVwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBleGNoYW5nZSA9IFwiU2hhbmdoYWkgRW5lcmd5IEV4Y2hhbmdlXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzdHkgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPGZvcmVpZ25PYmplY3Qgd2lkdGg9e2QueDEtZC54MH0gaGVpZ2h0PXtkLnkxLWQueTB9PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2ID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGU6IHtyZXN1bHRfbGlzdFs0XS5zbGljZSgtMikrJ1xcbid9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVm9sdW1lOiB7cmVzdWx0X2xpc3RbMV0rJ1xcbid9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVHJhZGluZyB2b2w6IHtyZXN1bHRfbGlzdFszXSsnXFxuJ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaGFycGU6IHtyZXN1bHRfbGlzdFsyXS5zbGljZSgwLDMpKydcXG4nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV4Y2hhbmdlOiB7ZXhjaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2ZvcmVpZ25PYmplY3Q+XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gPGZvcmVpZ25PYmplY3Qgd2lkdGg9eyhkLngxLWQueDApKjJ9IGhlaWdodD17KGQueTEtZC55MCkqMn0+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgPlxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICA8aDI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0ZToge3Jlc3VsdF9saXN0WzRdLnNsaWNlKC0yKSsnXFxuJ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWb2x1bWU6IHtyZXN1bHRfbGlzdFsxXSsnXFxuJ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUcmFkaW5nIHZvbDoge3Jlc3VsdF9saXN0WzNdKydcXG4nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNoYXJwZToge3Jlc3VsdF9saXN0WzJdLnNsaWNlKDAsMykrJ1xcbid9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRXhjaGFuZ2U6IHtleGNoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvaDI+XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZm9yZWlnbk9iamVjdD5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgIFxuXG4gICAgICAgIGZ1bmN0aW9uIFRyZWVNYXAocHJvcHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCwgZGF0YSwgZmlyc3QsIHNlY29uZCwgc2VsZWN0ZWRDZWxsLCBzZXRTZWxlY3RlZENlbGx9ID0gcHJvcHM7XG4gICAgICAgICAgICBjb25zdCBtYXJnaW4gPSB7IHRvcDogMjAsIHJpZ2h0OiA0MCwgYm90dG9tOiAyMCwgbGVmdDogNDAsIGdhcDogNDAgfTtcbiAgICAgICAgICAgIGNvbnN0IGlubmVyV2lkdGggPSB3aWR0aCAtIG1hcmdpbi5sZWZ0IC0gbWFyZ2luLnJpZ2h0O1xuICAgICAgICAgICAgY29uc3QgaW5uZXJIZWlnaHQgPSBoZWlnaHQgLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXMgPSBbXCJFeGNoYW5nZVwiLFwidm9sdW1lXCIsIFwiU2hhcnBlXCIsJ3RyYWRpbmd2b2x1bWUnLCd5bSddO1xuICAgICAgICAgXG4gICAgICAgICAgICB2YXIgcm9vdCA9IHtuYW1lOiBcInJvb3RcIiwgY2hpbGRyZW46IGJ1aWxkVHJlZShkYXRhLCBhdHRyaWJ1dGVzLCBmaXJzdCwgc2Vjb25kKSwgdmFsdWU6IDEwfTsgIFxuICAgICAgICAgXG5cbiAgICAgICAgICAgIHJvb3QgPSBkMy5oaWVyYXJjaHkocm9vdClcbiAgICAgICAgICAgICAgICAuc3VtKGQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkLmNoaWxkcmVuID8gMCA6IGQudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5jaGlsZHJlbiA/IDAgOiBkLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCB0cmVlID0gZDMudHJlZW1hcCgpLnRpbGUoZDMudHJlZW1hcFNxdWFyaWZ5KS5zaXplKFtpbm5lcldpZHRoLCBpbm5lckhlaWdodF0pLnBhZGRpbmcoMilcbiAgICAgICAgICAgICAgICAucm91bmQodHJ1ZSkocm9vdCkuc29ydCgoYSwgYikgPT4gYi52YWx1ZSAtIGEudmFsdWUpOztcblxuICAgICAgXG4gICAgICAgICAgICBpZiAoc2Vjb25kID09IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50cyA9IHRyZWUubGVhdmVzKCkubWFwKCBkID0+IGQucGFyZW50LmRhdGEuZ3JvdXBbMF1bJ3ltJ10pO1xuICAgICAgICAgICAgICAgIHZhciBhdHRyMiA9ICd5bSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRzID0gdHJlZS5sZWF2ZXMoKS5tYXAoIGQgPT4gZC5wYXJlbnQuZGF0YS5ncm91cFswXVsnRXhjaGFuZ2UnXSk7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHIyID0gJ0V4Y2hhbmdlJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IHBhcmVudHNDYXRlZ29yaWVzID0gcGFyZW50cy5maWx0ZXIoIChkLCBpZHgpID0+IHBhcmVudHMuaW5kZXhPZihkKSA9PT0gaWR4ICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gZDMuc2NhbGVPcmRpbmFsKGQzLnNjaGVtZVBhaXJlZCkuZG9tYWluKHBhcmVudHNDYXRlZ29yaWVzKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZmlyc3RMYXllciA9IHRyZWUuZGVzY2VuZGFudHMoKVswXS5jaGlsZHJlbjtcblxuICAgICAgICAgICAgY29uc3QgbW91c2VPdmVyID0gZCA9PiB7XG4gICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRDZWxsKGQpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgbW91c2VPdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRDZWxsKG51bGwpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IGxlZnRzID0gdHJlZS5sZWF2ZXMoKS5sZW5ndGhcbiAgICAgICAgICAgIGNvbnN0IGZpbmFsID0gdHJlZS5sZWF2ZXMoKVtsZWZ0cy0xXVxuICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIDxnIHRyYW5zZm9ybT17YHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0fSwgJHttYXJnaW4ucmlnaHR9KWB9PlxuICAgICAgICAgICAgICAgIDxzdmcgd2lkdGggPXt3aWR0aH0gaGVpZ2h0ID0ge2hlaWdodH0+XG5cbiAgICAgICAgICAgICAgICB7Zmlyc3RMYXllci5tYXAoIChkLCBpZHgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA8ZyBrZXk9e2lkeCtcIm91dGVybGluZVwifSB0cmFuc2Zvcm09e2B0cmFuc2xhdGUoJHtkLngwfSwgJHtkLnkwfSlgfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxyZWN0IHdpZHRoPXtkLngxLWQueDB9IGhlaWdodD17ZC55MS1kLnkwfSBzdHJva2U9e1wid2hpdGVcIn0gZmlsbD17XCJub25lXCJ9Lz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZXh0IHN0eWxlPXt7Zm9udFNpemU6XCI2ZW1cIiwgZmlsbDonV2hpdGUnfX0geD17IChkLngxLWQueDApLzIgfSB5PXsgKGQueTEtZC55MCkvMn0gdGV4dEFuY2hvcj17XCJtaWRkbGVcIn0gIFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtPXtgcm90YXRlKCR7KGQueDEtZC54MCk+KGQueTEtZC55MCk/IDA6IDkwfSwgJHsoZC54MS1kLngwKS8yfSwgJHsoZC55MS1kLnkwKS8yfSlgfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZC5kYXRhLm5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RleHQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2c+XG4gICAgICAgICAgICAgICAgfSl9XG5cblxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHt0cmVlLmxlYXZlcygpLm1hcCggKGQsIGlkeCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmZvID0gZDtcbiAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ2VsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdkID0gc2VsZWN0ZWRDZWxsLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZCA9IHNlbGVjdGVkQ2VsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2QgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmQuZGF0YS5ncm91cFswXVsnRXhjaGFuZ2UnXSA9PSBcIlNIRkVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYWdlX2luZm8gPSBcIlNoYW5naGFpLmh0bWxcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kLmRhdGEuZ3JvdXBbMF1bJ0V4Y2hhbmdlJ10gPT1cIkRDRVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhZ2VfaW5mbyA9IFwiRENFLmh0bWxcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kLmRhdGEuZ3JvdXBbMF1bJ0V4Y2hhbmdlJ10gPT0gXCJDWkNFXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFnZV9pbmZvID0gXCJDWkNFLmh0bWxcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kLmRhdGEuZ3JvdXBbMF1bJ0V4Y2hhbmdlJ10gPT0gXCJDRkZFWFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhZ2VfaW5mbyA9IFwiQ0ZGRVguaHRtbFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFnZV9pbmZvID0gXCJJTkUuaHRtbFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBpbmQuZGF0YS5ncm91cFswXVsneW0nXSsgJz0nK2luZC5kYXRhLmdyb3VwWzBdWydFeGNoYW5nZSddO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoZmluYWwudmFsdWUgPT0gZC52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gPGcga2V5PXtpZHgrXCJ0cmVlbWFwXCJ9IHRyYW5zZm9ybT17YHRyYW5zbGF0ZSgke2QueDB9LCAke2QueTB9KWB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Nb3VzZU92ZXI9IHsoKT0+IG1vdXNlT3ZlcihkKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3Qgd2lkdGg9e2QueDEtZC54MH0gaGVpZ2h0PXtkLnkxLWQueTB9IHN0cm9rZT17XCJub25lXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbD17Y29sb3IoZC5wYXJlbnQuZGF0YS5ncm91cFswXVthdHRyMl0pfSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5PXswLjZ9Lz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJlZU1hcFRleHQgZD17ZH0gc3R5ID17MH0vPiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZz5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxnIGtleT17aWR4K1widHJlZW1hcFwifSB0cmFuc2Zvcm09e2B0cmFuc2xhdGUoJHtkLngwfSwgJHtkLnkwfSlgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbk1vdXNlT3Zlcj0geygpPT4gbW91c2VPdmVyKGQpfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3Qgd2lkdGg9e2QueDEtZC54MH0gaGVpZ2h0PXtkLnkxLWQueTB9IHN0cm9rZT17XCJub25lXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGw9e2NvbG9yKGQucGFyZW50LmRhdGEuZ3JvdXBbMF1bYXR0cjJdKX0gb3BhY2l0eT17MC45fS8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmVlTWFwVGV4dCBkPXtkfSBzdHkgPXswfS8+IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e3BhZ2VfaW5mbysnP2lkPScrZGF0ZX0gPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT17YHRyYW5zbGF0ZSgke2luZC54MH0sICR7aW5kLnkwfSlgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uTW91c2VPdmVyPSB7KCk9PiBtb3VzZU92ZXIoaW5kKX0gb25Nb3VzZU91dCA9IHttb3VzZU91dH0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxyZWN0IHdpZHRoPXsoaW5kLngxLWluZC54MCkqMn0gaGVpZ2h0PXsoaW5kLnkxLWluZC55MCkqMn0gc3Ryb2tlPXtcIm5vbmVcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbD17Y29sb3IoaW5kLnBhcmVudC5kYXRhLmdyb3VwWzBdW2F0dHIyXSl9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJlZU1hcFRleHQgZD17aW5kfSBzdHkgPXsxfS8+IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9nPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gPGcga2V5PXtpZHgrXCJ0cmVlbWFwXCJ9IHRyYW5zZm9ybT17YHRyYW5zbGF0ZSgke2QueDB9LCAke2QueTB9KWB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Nb3VzZU92ZXI9IHsoKT0+IG1vdXNlT3ZlcihkKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8cmVjdCB3aWR0aD17ZC54MS1kLngwfSBoZWlnaHQ9e2QueTEtZC55MH0gc3Ryb2tlPXtcIm5vbmVcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsPXtjb2xvcihkLnBhcmVudC5kYXRhLmdyb3VwWzBdW2F0dHIyXSl9IG9wYWNpdHk9ezAuOX0vPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRyZWVNYXBUZXh0IGQ9e2R9IHN0eSA9ezB9Lz4gXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2c+XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgICAgICA8L2c+XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZnVuY3Rpb24gYnVpbGRUcmVlKGRhdGEsIGF0dHJpYnV0ZXMsZmlyc3QsIHNlY29uZCkge1xuICAgICAgICAgICAgbGV0IGl0ZW1BcnIgPSBbXTtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmxlbmd0aCA9PT0gMCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgZ3JvdXBzID0gZDMuZ3JvdXBzKCBkYXRhLCBkID0+IGRbYXR0cmlidXRlc1tzZWNvbmRdXSk7XG4gICAgICAgICAgICBsZXQgbGV2ZWxzID0gZ3JvdXBzLm1hcCggZCA9PiBkWzBdKTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZXZlbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgdm9sdW1lX3NpemUgPSBncm91cHNbaV1bMV0uZmlsdGVyKCBkID0+IGQudm9sdW1lKS9ncm91cHNbaV1bMV0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGl0ZW1BcnIucHVzaCh7bmFtZTogbGV2ZWxzW2ldLCBjaGlsZHJlbjogYnVpbGRUcmVlKGdyb3Vwc1tpXVsxXSwgYXR0cmlidXRlcy5zbGljZSgxKSwgZmlyc3QsMCksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBncm91cHNbaV1bMV1bMF1bZmlyc3RdLCBncm91cDogZ3JvdXBzW2ldWzFdfSk7XG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1BcnI7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBEcm9wZG93biAocHJvcHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgb3B0aW9ucywgc2VsZWN0ZWRWYWx1ZSwgb25TZWxlY3RlZFZhbHVlQ2hhbmdlIH0gPSBwcm9wcztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3MgPSAnc2VsZWN0Jz48c2VsZWN0IGRlZmF1bHRWYWx1ZT17c2VsZWN0ZWRWYWx1ZX0gb25DaGFuZ2U9e2V2ZW50ID0+IHsgb25TZWxlY3RlZFZhbHVlQ2hhbmdlKGV2ZW50LnRhcmdldC52YWx1ZSl9fT5cbiAgICAgICAgICAgICAgICB7b3B0aW9ucy5tYXAoICh7dmFsdWUsIGxhYmVsfSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPG9wdGlvbiBrZXk9e2xhYmVsfSB2YWx1ZT17dmFsdWV9ID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtsYWJlbH1cbiAgICAgICAgICAgICAgICAgICAgPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBIb21lX3BhZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBbZmlyc3RBdHRyLCBzZXRGaXJzdEF0dHJdID0gUmVhY3QudXNlU3RhdGUoXCJTaGFycGVcIik7IFxuICAgICAgICAgICAgY29uc3QgW3NlY29uZEF0dHIsIHNldFNlY29uZEF0dHJdID0gUmVhY3QudXNlU3RhdGUoMCk7IFxuICAgICAgICAgICAgY29uc3QgW3llYXIsIHNldFllYXJdID0gUmVhY3QudXNlU3RhdGUoJzEnKTtcbiAgICAgICAgICAgIGNvbnN0IFtzZWxlY3RlZENlbGwsIHNldFNlbGVjdGVkQ2VsbF0gPSBSZWFjdC51c2VTdGF0ZShudWxsKTtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkPSAnU2hhcnBlJztcbiAgICAgICAgICAgIGNvbnN0IGRhdGFBbGwgPSB1c2VEYXRhKGNzdlVybCk7XG4gICAgICAgICAgICBjb25zdCBZRUFSID0gWycyMDE3JywnMjAxOCcsJzIwMTknLCcyMDIwJ107XG4gICAgICAgICAgICBpZiAoIWRhdGFBbGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gPHA+XG4gICAgICAgICAgICAgICAgICAgIExvYWRpbmcuLi5cbiAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBkYXRhQWxsLmZpbHRlciggZCA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQueW0uc2xpY2UoMCwgNCkgPT0gWUVBUlt5ZWFyXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgb25GcmlzdEF0dHJDaGFuZ2UgPSAoIGF0dHIgKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0Rmlyc3RBdHRyKGF0dHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgb25TZWNvbmRBdHRyQ2hhbmdlID0gKCBhdHRyICkgPT4ge1xuICAgICAgICAgICAgICAgIHNldFNlY29uZEF0dHIoYXR0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjaGFuZ2VIYW5kbGVyWWVhciA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldFllYXIoZXZlbnQudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0gW3t2YWx1ZTogXCJ2b2x1bWVcIiwgbGFiZWw6IFwiVm9sdW1lXCJ9LHt2YWx1ZTogXCJTaGFycGVcIiwgbGFiZWw6IFwiU2hhcnBlXCJ9LCB7dmFsdWU6IFwidHJhZGluZ3ZvbHVtZVwiLCBsYWJlbDpcIlRyYWRpbmcgVm9sdW1lXCJ9LF07XG4gICAgICAgICAgICBjb25zdCBvcHRpb25zMiA9IFt7dmFsdWU6IDQsIGxhYmVsOiBcIkRhdGVcIn0se3ZhbHVlOjAsIGxhYmVsOiBcIkV4Y2hhbmdlXCJ9XTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIDxkaXY+XG4gICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgPGEgaHJlZiA9ICdpbmRleC5odG1sJyBmaWxsID0gJ2JsYWNrJz5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcyA9ICdidXR0b24nPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRleHQgc3R5bGU9e3sgdGV4dEFuY2hvcjonYm90dG9tJywgZm9udFNpemU6JzJlbSd9fSBmaWxsID0gJ2JsYWNrJyB4ID0ge1wiMCVcIn0geSA9IHtcIjBcIn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTC5GLiBDYXBpdGFsXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RleHQ+XG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgIDxzdmcgd2lkdGggPSAnMTAwJScgaGVpZ2h0ID0gJzEnPlxuICAgICAgICAgICAgICAgICAgICA8bGluZSAgeDI9XCIxMDAlXCIgeTE9XCIxMDAlXCIgeTI9XCIxMDAlXCIgc3Ryb2tlID0gXCJXaGl0ZVwiLz5cbiAgICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cblxuICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgIDxEcm9wZG93biBvcHRpb25zPXtvcHRpb25zfSBzZWxlY3RlZFZhbHVlPXtmaXJzdEF0dHJ9IG9uU2VsZWN0ZWRWYWx1ZUNoYW5nZT17b25GcmlzdEF0dHJDaGFuZ2V9Lz5cbiAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duIG9wdGlvbnM9e29wdGlvbnMyfSBzZWxlY3RlZFZhbHVlPXtzZWNvbmRBdHRyfSBvblNlbGVjdGVkVmFsdWVDaGFuZ2U9e29uU2Vjb25kQXR0ckNoYW5nZX0vPiAgIFxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQga2V5PVwic2xpZGVyXCIgdHlwZT0ncmFuZ2UnIGNsYXNzID0gJ3NsaWRlcicgbGlzdD1cInRpY2ttYXJrc1wiIG1pbj0nMCcgbWF4PSczJyB2YWx1ZT17eWVhcn0gIHN0ZXA9JzEnIG9uQ2hhbmdlPXtjaGFuZ2VIYW5kbGVyWWVhcn0vPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRhdGFsaXN0IGlkPVwidGlja21hcmtzXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjBcIj48L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMVwiPjwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIyXCI+PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjNcIj48L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGF0YWxpc3Q+XG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dCBrZXk9XCJtb250aFRleHRcIiBjbGFzcz0nbGFiZWxpbnB1dCcgdHlwZT1cInRleHRcIiB2YWx1ZT17J1llYXIgJytZRUFSW3llYXJdfSByZWFkT25seS8+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICA8ZGl2PiBcbiAgICAgICAgICAgICAgICA8c3ZnIHdpZHRoID17MTUwfSBoZWlnaHQgPSB7NDAwfSBmaWxsID17XCJibGFja1wifT5cbiAgICAgICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09e2B0cmFuc2xhdGUoJHsyMDB9LCAkezB9KWB9PlxuICAgICAgICAgICAgICAgIDxUcmVlTWFwIHdpZHRoPXtXSURUSH0gaGVpZ2h0PXtIRUlHSFR9IGRhdGEgPSB7ZGF0YX0gZmlyc3QgPSB7Zmlyc3RBdHRyfSBzZWNvbmQgPSB7c2Vjb25kQXR0cn0gc2VsZWN0ZWRDZWxsPXtzZWxlY3RlZENlbGx9IHNldFNlbGVjdGVkQ2VsbD17c2V0U2VsZWN0ZWRDZWxsfSAvPiAgICAgICBcbiAgICAgICAgICAgICAgICA8L2c+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgUmVhY3RET00ucmVuZGVyKCA8SG9tZV9wYWdlLz4sIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JykpO1xuICAgICAgICAiXX0=</script></head>
<body>
    <div id="root"><div><div><a href="index.html" fill="black"><button class="button"><text fill="black" x="0%" y="0" style="font-size: 2em;">Capstone - Vizualization</text></button></a><svg width="100%" height="1"><line x2="100%" y1="100%" y2="100%" stroke="White"></line></svg></div><div><div class="select"><select><option value="volume">Volume</option><option value="Sharpe" selected="">Sharpe</option><option value="tradingvolume">Trading Volume</option></select></div><div class="select"><select><option value="4">Date</option><option value="0" selected="">Exchange</option></select></div><input type="range" class="slider" list="tickmarks" min="0" max="3" step="1" value="1"><datalist id="tickmarks"><option value="0"></option><option value="1"></option><option value="2"></option><option value="3"></option></datalist><input class="labelinput" type="text" readonly="" value="Year 2018"></div><div><svg width="150" height="400" fill="black"></svg><g transform="translate(200, 0)"><g transform="translate(40, 40)"><svg width="1300" height="800"><g transform="translate(2, 2)"><rect width="507" height="379" stroke="white" fill="none"></rect><text x="253.5" y="189.5" text-anchor="middle" transform="rotate(0, 253.5, 189.5)" style="font-size: 6em; fill: white;">CFFEX</text></g><g transform="translate(862, 2)"><rect width="356" height="536" stroke="white" fill="none"></rect><text x="178" y="268" text-anchor="middle" transform="rotate(90, 178, 268)" style="font-size: 6em; fill: white;">SHFE</text></g><g transform="translate(2, 383)"><rect width="507" height="375" stroke="white" fill="none"></rect><text x="253.5" y="187.5" text-anchor="middle" transform="rotate(0, 253.5, 187.5)" style="font-size: 6em; fill: white;">CZCE</text></g><g transform="translate(511, 2)"><rect width="349" height="536" stroke="white" fill="none"></rect><text x="174.5" y="268" text-anchor="middle" transform="rotate(90, 174.5, 268)" style="font-size: 6em; fill: white;">DCE</text></g><g transform="translate(511, 540)"><rect width="707" height="218" stroke="white" fill="none"></rect><text x="353.5" y="109" text-anchor="middle" transform="rotate(0, 353.5, 109)" style="font-size: 6em; fill: white;">INE</text></g><g transform="translate(10, 143)"><rect width="199" height="81" stroke="none" fill="#a6cee3" opacity="0.9"></rect><foreignObject width="199" height="81"><div><p>Date: 06
Volume: 19
Trading vol: 22
Sharpe: 3.7
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(10, 10)"><rect width="114" height="123" stroke="none" fill="#1f78b4" opacity="0.9"></rect><foreignObject width="114" height="123"><div><p>Date: 01
Volume: 19
Trading vol: 19
Sharpe: 3.2
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(134, 10)"><rect width="75" height="123" stroke="none" fill="#b2df8a" opacity="0.9"></rect><foreignObject width="75" height="123"><div><p>Date: 03
Volume: 19
Trading vol: 19
Sharpe: 2.2
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(223, 10)"><rect width="73" height="206" stroke="none" fill="#33a02c" opacity="0.9"></rect><foreignObject width="73" height="206"><div><p>Date: 05
Volume: 20
Trading vol: 19
Sharpe: 3.5
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(306, 10)"><rect width="62" height="206" stroke="none" fill="#fb9a99" opacity="0.9"></rect><foreignObject width="62" height="206"><div><p>Date: 09
Volume: 20
Trading vol: 21
Sharpe: 3.0
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(382, 10)"><rect width="119" height="101" stroke="none" fill="#e31a1c" opacity="0.9"></rect><foreignObject width="119" height="101"><div><p>Date: 07
Volume: 23
Trading vol: 21
Sharpe: 2.8
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(382, 121)"><rect width="119" height="95" stroke="none" fill="#fdbf6f" opacity="0.9"></rect><foreignObject width="119" height="95"><div><p>Date: 10
Volume: 23
Trading vol: 18
Sharpe: 2.7
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(10, 305)"><rect width="199" height="68" stroke="none" fill="#ff7f00" opacity="0.9"></rect><foreignObject width="199" height="68"><div><p>Date: 04
Volume: 18
Trading vol: 19
Sharpe: 3.3
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(410, 230)"><rect width="91" height="143" stroke="none" fill="#cab2d6" opacity="0.9"></rect><foreignObject width="91" height="143"><div><p>Date: 12
Volume: 32
Trading vol: 23
Sharpe: 3.1
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(223, 230)"><rect width="173" height="66" stroke="none" fill="#6a3d9a" opacity="0.9"></rect><foreignObject width="173" height="66"><div><p>Date: 08
Volume: 28
Trading vol: 32
Sharpe: 2.8
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(223, 310)"><rect width="173" height="63" stroke="none" fill="#ffff99" opacity="0.9"></rect><foreignObject width="173" height="63"><div><p>Date: 11
Volume: 29
Trading vol: 38
Sharpe: 2.7
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(10, 238)"><rect width="199" height="53" stroke="none" fill="#b15928" opacity="0.9"></rect><foreignObject width="199" height="53"><div><p>Date: 02
Volume: 15
Trading vol: 14
Sharpe: 2.7
Exchange: China Financial Futures Exchange</p></div></foreignObject></g><g transform="translate(1126, 10)"><rect width="84" height="167" stroke="none" fill="#ff7f00" opacity="0.9"></rect><foreignObject width="84" height="167"><div><p>Date: 04
Volume: 1002
Trading vol: 1245
Sharpe: 3.3
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(870, 365)"><rect width="168" height="80" stroke="none" fill="#e31a1c" opacity="0.9"></rect><foreignObject width="168" height="80"><div><p>Date: 07
Volume: 1023
Trading vol: 691
Sharpe: 3.2
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(870, 191)"><rect width="168" height="77" stroke="none" fill="#33a02c" opacity="0.9"></rect><foreignObject width="168" height="77"><div><p>Date: 05
Volume: 920
Trading vol: 1172
Sharpe: 3.1
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(958, 10)"><rect width="76" height="167" stroke="none" fill="#b15928" opacity="0.9"></rect><foreignObject width="76" height="167"><div><p>Date: 02
Volume: 512
Trading vol: 422
Sharpe: 3.1
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(1134, 362)"><rect width="76" height="168" stroke="none" fill="#cab2d6" opacity="0.9"></rect><foreignObject width="76" height="168"><div><p>Date: 12
Volume: 1136
Trading vol: 1331
Sharpe: 3.1
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(870, 10)"><rect width="74" height="167" stroke="none" fill="#1f78b4" opacity="0.9"></rect><foreignObject width="74" height="167"><div><p>Date: 01
Volume: 861
Trading vol: 966
Sharpe: 3.0
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(870, 459)"><rect width="168" height="71" stroke="none" fill="#6a3d9a" opacity="0.9"></rect><foreignObject width="168" height="71"><div><p>Date: 08
Volume: 1199
Trading vol: 975
Sharpe: 2.9
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(870, 282)"><rect width="168" height="69" stroke="none" fill="#a6cee3" opacity="0.9"></rect><foreignObject width="168" height="69"><div><p>Date: 06
Volume: 893
Trading vol: 978
Sharpe: 2.8
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(1052, 362)"><rect width="68" height="168" stroke="none" fill="#ffff99" opacity="0.9"></rect><foreignObject width="68" height="168"><div><p>Date: 11
Volume: 1232
Trading vol: 1502
Sharpe: 2.8
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(1052, 191)"><rect width="74" height="157" stroke="none" fill="#fb9a99" opacity="0.9"></rect><foreignObject width="74" height="157"><div><p>Date: 09
Volume: 963
Trading vol: 983
Sharpe: 2.8
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(1140, 191)"><rect width="70" height="157" stroke="none" fill="#fdbf6f" opacity="0.9"></rect><foreignObject width="70" height="157"><div><p>Date: 10
Volume: 883
Trading vol: 978
Sharpe: 2.7
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(1048, 10)"><rect width="64" height="167" stroke="none" fill="#b2df8a" opacity="0.9"></rect><foreignObject width="64" height="167"><div><p>Date: 03
Volume: 1112
Trading vol: 789
Sharpe: 2.6
Exchange: Shanghai Futures Exchange</p></div></foreignObject></g><g transform="translate(286, 391)"><rect width="107" height="137" stroke="none" fill="#a6cee3" opacity="0.9"></rect><foreignObject width="107" height="137"><div><p>Date: 06
Volume: 782
Trading vol: 1031
Sharpe: 3.4
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(10, 391)"><rect width="155" height="87" stroke="none" fill="#1f78b4" opacity="0.9"></rect><foreignObject width="155" height="87"><div><p>Date: 01
Volume: 434
Trading vol: 526
Sharpe: 3.2
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(407, 391)"><rect width="94" height="137" stroke="none" fill="#e31a1c" opacity="0.9"></rect><foreignObject width="94" height="137"><div><p>Date: 07
Volume: 658
Trading vol: 652
Sharpe: 3.1
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(10, 580)"><rect width="155" height="82" stroke="none" fill="#b2df8a" opacity="0.9"></rect><foreignObject width="155" height="82"><div><p>Date: 03
Volume: 594
Trading vol: 366
Sharpe: 3.0
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(179, 391)"><rect width="93" height="137" stroke="none" fill="#33a02c" opacity="0.9"></rect><foreignObject width="93" height="137"><div><p>Date: 05
Volume: 958
Trading vol: 723
Sharpe: 3.0
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(412, 542)"><rect width="89" height="138" stroke="none" fill="#ffff99" opacity="0.9"></rect><foreignObject width="89" height="138"><div><p>Date: 11
Volume: 764
Trading vol: 687
Sharpe: 2.9
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(312, 542)"><rect width="86" height="138" stroke="none" fill="#fdbf6f" opacity="0.9"></rect><foreignObject width="86" height="138"><div><p>Date: 10
Volume: 591
Trading vol: 697
Sharpe: 2.9
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(179, 649)"><rect width="119" height="101" stroke="none" fill="#fb9a99" opacity="0.9"></rect><foreignObject width="119" height="101"><div><p>Date: 09
Volume: 644
Trading vol: 728
Sharpe: 2.8
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(10, 492)"><rect width="155" height="74" stroke="none" fill="#b15928" opacity="0.9"></rect><foreignObject width="155" height="74"><div><p>Date: 02
Volume: 277
Trading vol: 205
Sharpe: 2.8
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(10, 676)"><rect width="155" height="74" stroke="none" fill="#ff7f00" opacity="0.9"></rect><foreignObject width="155" height="74"><div><p>Date: 04
Volume: 458
Trading vol: 549
Sharpe: 2.8
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(312, 694)"><rect width="189" height="56" stroke="none" fill="#cab2d6" opacity="0.9"></rect><foreignObject width="189" height="56"><div><p>Date: 12
Volume: 787
Trading vol: 994
Sharpe: 2.7
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(179, 542)"><rect width="119" height="93" stroke="none" fill="#6a3d9a" opacity="0.9"></rect><foreignObject width="119" height="93"><div><p>Date: 08
Volume: 1181
Trading vol: 1291
Sharpe: 2.7
Exchange: Zhengzhou Commodity Exchange</p></div></foreignObject></g><g transform="translate(519, 10)"><rect width="109" height="128" stroke="none" fill="#1f78b4" opacity="0.9"></rect><foreignObject width="109" height="128"><div><p>Date: 01
Volume: 720
Trading vol: 516
Sharpe: 3.2
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(652, 325)"><rect width="101" height="136" stroke="none" fill="#fdbf6f" opacity="0.9"></rect><foreignObject width="101" height="136"><div><p>Date: 10
Volume: 696
Trading vol: 819
Sharpe: 3.2
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(687, 152)"><rect width="79" height="159" stroke="none" fill="#a6cee3" opacity="0.9"></rect><foreignObject width="79" height="159"><div><p>Date: 06
Volume: 809
Trading vol: 670
Sharpe: 3.0
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(752, 10)"><rect width="100" height="128" stroke="none" fill="#b2df8a" opacity="0.9"></rect><foreignObject width="100" height="128"><div><p>Date: 03
Volume: 1094
Trading vol: 763
Sharpe: 3.0
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(642, 10)"><rect width="96" height="128" stroke="none" fill="#b15928" opacity="0.9"></rect><foreignObject width="96" height="128"><div><p>Date: 02
Volume: 438
Trading vol: 481
Sharpe: 2.9
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(598, 152)"><rect width="75" height="159" stroke="none" fill="#33a02c" opacity="0.9"></rect><foreignObject width="75" height="159"><div><p>Date: 05
Volume: 939
Trading vol: 943
Sharpe: 2.9
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(519, 325)"><rect width="119" height="100" stroke="none" fill="#6a3d9a" opacity="0.9"></rect><foreignObject width="119" height="100"><div><p>Date: 08
Volume: 914
Trading vol: 1175
Sharpe: 2.8
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(652, 475)"><rect width="200" height="55" stroke="none" fill="#cab2d6" opacity="0.9"></rect><foreignObject width="200" height="55"><div><p>Date: 12
Volume: 761
Trading vol: 828
Sharpe: 2.8
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(780, 152)"><rect width="72" height="159" stroke="none" fill="#e31a1c" opacity="0.9"></rect><foreignObject width="72" height="159"><div><p>Date: 07
Volume: 741
Trading vol: 740
Sharpe: 2.8
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(767, 325)"><rect width="85" height="136" stroke="none" fill="#ffff99" opacity="0.9"></rect><foreignObject width="85" height="136"><div><p>Date: 11
Volume: 903
Trading vol: 925
Sharpe: 2.7
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(519, 439)"><rect width="119" height="91" stroke="none" fill="#fb9a99" opacity="0.9"></rect><foreignObject width="119" height="91"><div><p>Date: 09
Volume: 668
Trading vol: 796
Sharpe: 2.6
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(519, 152)"><rect width="65" height="159" stroke="none" fill="#ff7f00" opacity="0.9"></rect><foreignObject width="65" height="159"><div><p>Date: 04
Volume: 1004
Trading vol: 957
Sharpe: 2.6
Exchange: Dalian Commodity Exchange</p></div></foreignObject></g><g transform="translate(767, 548)"><rect width="114" height="111" stroke="none" fill="#e31a1c" opacity="0.9"></rect><foreignObject width="114" height="111"><div><p>Date: 07
Volume: 27
Trading vol: 20
Sharpe: 2.9
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g><g transform="translate(891, 548)"><rect width="76" height="111" stroke="none" fill="#fb9a99" opacity="0.9"></rect><foreignObject width="76" height="111"><div><p>Date: 09
Volume: 27
Trading vol: 37
Sharpe: 2.0
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g><g transform="translate(981, 619)"><rect width="148" height="131" stroke="none" fill="#ffff99" opacity="0.9"></rect><foreignObject width="148" height="131"><div><p>Date: 11
Volume: 45
Trading vol: 69
Sharpe: 4.4
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g><g transform="translate(767, 673)"><rect width="200" height="77" stroke="none" fill="#6a3d9a" opacity="0.9"></rect><foreignObject width="200" height="77"><div><p>Date: 08
Volume: 33
Trading vol: 30
Sharpe: 3.7
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g><g transform="translate(606, 548)"><rect width="147" height="106" stroke="none" fill="#33a02c" opacity="0.9"></rect><foreignObject width="147" height="106"><div><p>Date: 05
Volume: 18
Trading vol: 18
Sharpe: 3.6
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g><g transform="translate(1143, 548)"><rect width="67" height="202" stroke="none" fill="#cab2d6" opacity="0.9"></rect><foreignObject width="67" height="202"><div><p>Date: 12
Volume: 50
Trading vol: 66
Sharpe: 3.3
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g><g transform="translate(606, 668)"><rect width="147" height="82" stroke="none" fill="#a6cee3" opacity="0.9"></rect><foreignObject width="147" height="82"><div><p>Date: 06
Volume: 22
Trading vol: 2
Sharpe: 2.9
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g><g transform="translate(519, 548)"><rect width="73" height="137" stroke="none" fill="#b2df8a" opacity="0.9"></rect><foreignObject width="73" height="137"><div><p>Date: 03
Volume: 1
Trading vol: 2
Sharpe: 2.4
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g><g transform="translate(981, 548)"><rect width="148" height="57" stroke="none" fill="#fdbf6f" opacity="0.9"></rect><foreignObject width="148" height="57"><div><p>Date: 10
Volume: 30
Trading vol: 14
Sharpe: 2.1
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g><g transform="translate(519, 699)"><rect width="73" height="51" stroke="none" fill="#ff7f00" opacity="0.6"></rect><foreignObject width="73" height="51"><div><p>Date: 04
Volume: 6
Trading vol: 6
Sharpe: 1.0
Exchange: Shanghai Energy Exchange</p></div></foreignObject></g></svg></g></g></div></div></div>
    <script type="text/babel">

        const WIDTH = 1300;
        const HEIGHT = 800;
        const margin = { top: 20, right: 40, bottom: 20, left: 40 };
        var csvUrl = 'futures_data.csv';

        function useData(csvPath){
            const [dataAll, setData] = React.useState(null);
            React.useEffect(() => {
                d3.csv(csvPath).then(data => {
                    data.forEach(d => {
                        d.index =+ d.index;
                        d.volume =+ Math.floor(d.volume/100000);
                        d.tradingvolume= + Math.floor(d.tradingvolume/1000);
                        d.Sharpe= +d.Sharpe;
                
                    });
                    setData(data);
                });
            }, []);
            return dataAll;
        }


        function TreeMapText(props) {
            const {d, sty} = props;
            const result = d.ancestors().reverse().slice(1).map((d, idx) => d.data.name)
                        .join("\n")+"\nSharpe:"+d3.format("")(d.value)
            const result_list = result.split("\n"); 
            if (result_list[0]=='DCE') {
                var exchange = "Dalian Commodity Exchange";
            } else if (result_list[0]=='CFFEX') {
                var exchange = "China Financial Futures Exchange";
            } else if (result_list[0]=='SHFE') {
                var exchange = "Shanghai Futures Exchange";
            } else if (result_list[0]=='CZCE') {
                var exchange = "Zhengzhou Commodity Exchange";
            } else {
                var exchange = "Shanghai Energy Exchange";
            }
            if (sty == 0) {
                return <foreignObject width={d.x1-d.x0} height={d.y1-d.y0}>
                <div >
                    <p>
                        Date: {result_list[4].slice(-2)+'\n'}
                        Volume: {result_list[1]+'\n'}
                        Trading vol: {result_list[3]+'\n'}
                        Sharpe: {result_list[2].slice(0,3)+'\n'}
                        Exchange: {exchange}
                    </p>
                </div>
                </foreignObject>
            } else {
            return <foreignObject width={(d.x1-d.x0)*2} height={(d.y1-d.y0)*2}>
                <div >
                    
                    <h2>
                        Date: {result_list[4].slice(-2)+'\n'}
                        Volume: {result_list[1]+'\n'}
                        Trading vol: {result_list[3]+'\n'}
                        Sharpe: {result_list[2].slice(0,3)+'\n'}
                        Exchange: {exchange}
                    </h2>
                    
                </div>
                </foreignObject>
            }
        }

  

    function TreeMap(props) {
        const { width, height, data, first, second, selectedCell, setSelectedCell} = props;
        const margin = { top: 20, right: 40, bottom: 20, left: 40, gap: 40 };
        const innerWidth = width - margin.left - margin.right;
        const innerHeight = height - margin.top - margin.bottom;
        
        let attributes = ["Exchange","volume", "Sharpe",'tradingvolume','ym'];
     
        var root = {name: "root", children: buildTree(data, attributes, first, second), value: 10};  
     

        root = d3.hierarchy(root)
            .sum(d => {
                // console.log(d.children ? 0 : d.value);
                return d.children ? 0 : d.value;
            });
        
        const tree = d3.treemap().tile(d3.treemapSquarify).size([innerWidth, innerHeight]).padding(2)
            .round(true)(root).sort((a, b) => b.value - a.value);;

  
        if (second == 0) {
            var parents = tree.leaves().map( d => d.parent.data.group[0]['ym']);
            var attr2 = 'ym';
        } else {
            var parents = tree.leaves().map( d => d.parent.data.group[0]['Exchange']);
            var attr2 = 'Exchange';
        }

        let parentsCategories = parents.filter( (d, idx) => parents.indexOf(d) === idx );
        
        const color = d3.scaleOrdinal(d3.schemePaired).domain(parentsCategories);
        
        const firstLayer = tree.descendants()[0].children;

        const mouseOver = d => {
            setSelectedCell(d);
        };

        const mouseOut = () => {
            setSelectedCell(null);
        };
        const lefts = tree.leaves().length
        const final = tree.leaves()[lefts-1]
       
        
        return <g transform={`translate(${margin.left}, ${margin.right})`}>
            <svg width ={width} height = {height}>

            {firstLayer.map( (d, idx) => {
                
                return <g key={idx+"outerline"} transform={`translate(${d.x0}, ${d.y0})`}>
                    <rect width={d.x1-d.x0} height={d.y1-d.y0} stroke={"white"} fill={"none"}/>
                    <text style={{fontSize:"6em", fill:'White'}} x={ (d.x1-d.x0)/2 } y={ (d.y1-d.y0)/2} textAnchor={"middle"}  
                    transform={`rotate(${(d.x1-d.x0)>(d.y1-d.y0)? 0: 90}, ${(d.x1-d.x0)/2}, ${(d.y1-d.y0)/2})`}>
                        {d.data.name}
                    </text>
                    </g>
            })}


            
            {tree.leaves().map( (d, idx) => {
                const info = d;
         
                if (selectedCell) {
                    var gd = selectedCell.value;
                    var ind = selectedCell;
                   
                } else {
                    var gd = null;
                }
                if (ind) {
                    if (ind.data.group[0]['Exchange'] == "SHFE") {
                        var page_info = "Shanghai.html";
                    } else if (ind.data.group[0]['Exchange'] =="DCE") {
                        var page_info = "DCE.html";
                    } else if (ind.data.group[0]['Exchange'] == "CZCE") {
                        var page_info = "CZCE.html";
                    } else if (ind.data.group[0]['Exchange'] == "CFFEX") {
                        var page_info = "CFFEX.html";
                    } else {
                        var page_info = "INE.html";
                    }
                    var date = ind.data.group[0]['ym']+ '='+ind.data.group[0]['Exchange'];
                }
                
                if (final.value == d.value) {
                    if (!ind) {
                        return <g key={idx+"treemap"} transform={`translate(${d.x0}, ${d.y0})`}
                        onMouseOver= {()=> mouseOver(d)}>
                                    <rect width={d.x1-d.x0} height={d.y1-d.y0} stroke={"none"}
                                    fill={color(d.parent.data.group[0][attr2])} 
                                    opacity={0.6}/>
                                    <TreeMapText d={d} sty ={0}/> 
                                </g>
                    } else {
                        return <g>
                        <g key={idx+"treemap"} transform={`translate(${d.x0}, ${d.y0})`} 
                        onMouseOver= {()=> mouseOver(d)}>
                            <rect width={d.x1-d.x0} height={d.y1-d.y0} stroke={"none"}
                            fill={color(d.parent.data.group[0][attr2])} opacity={0.9}/>
                            <TreeMapText d={d} sty ={0}/> 
                        </g>

                        <a href={page_info+'?id='+date} >
                        <g transform={`translate(${ind.x0}, ${ind.y0})`}
                        onMouseOver= {()=> mouseOver(ind)} onMouseOut = {mouseOut}>
                            <rect width={(ind.x1-ind.x0)*2} height={(ind.y1-ind.y0)*2} stroke={"none"}
                            fill={color(ind.parent.data.group[0][attr2])} 
                            />
                            <TreeMapText d={ind} sty ={1}/> 
                        </g>
                        </a>
                        
                        </g>
                        
                    }
                    
                } else {
                    return <g key={idx+"treemap"} transform={`translate(${d.x0}, ${d.y0})`}
                        onMouseOver= {()=> mouseOver(d)}>
                    <rect width={d.x1-d.x0} height={d.y1-d.y0} stroke={"none"}
                        fill={color(d.parent.data.group[0][attr2])} opacity={0.9}/>
                    <TreeMapText d={d} sty ={0}/> 
                    </g>
                
                } 
                
            })}
            
            </svg>
            </g>
        
    }
    
    function buildTree(data, attributes,first, second) {
        let itemArr = [];
        if (attributes.length === 0){
            return null;
        }
        let groups = d3.groups( data, d => d[attributes[second]]);
        let levels = groups.map( d => d[0]);

        for (let i = 0; i < levels.length; i++) {
            let volume_size = groups[i][1].filter( d => d.volume)/groups[i][1].length;
            itemArr.push({name: levels[i], children: buildTree(groups[i][1], attributes.slice(1), first,0),
                value: groups[i][1][0][first], group: groups[i][1]});
        } 
        return itemArr;
    }

    function Dropdown (props) {
        const { options, selectedValue, onSelectedValueChange } = props;
        
        return <div class = 'select'><select defaultValue={selectedValue} onChange={event => { onSelectedValueChange(event.target.value)}}>
            {options.map( ({value, label}) => {
                return <option key={label} value={value} >
                    {label}
                </option>
            })}
        </select>
        </div>
     
    }

    const Home_page = () => {
        const [firstAttr, setFirstAttr] = React.useState("Sharpe"); 
        const [secondAttr, setSecondAttr] = React.useState(0); 
        const [year, setYear] = React.useState('1');
        const [selectedCell, setSelectedCell] = React.useState(null);
        const selected= 'Sharpe';
        const dataAll = useData(csvUrl);
        const YEAR = ['2017','2018','2019','2020'];
        if (!dataAll) {
            return <p>
                Loading...
            </p>
        }

        const data = dataAll.filter( d => {
            return d.ym.slice(0, 4) == YEAR[year];
        });
        const onFristAttrChange = ( attr ) => {
            setFirstAttr(attr);
        }
        const onSecondAttrChange = ( attr ) => {
            setSecondAttr(attr);
        }
        const changeHandlerYear = (event) => {
            setYear(event.target.value);
        }
        
        
        const options = [{value: "volume", label: "Volume"},{value: "Sharpe", label: "Sharpe"}, {value: "tradingvolume", label:"Trading Volume"},];
        const options2 = [{value: 4, label: "Date"},{value:0, label: "Exchange"}];
        
        return <div>
            <div>
                <a href = 'index.html' fill = 'black'>
                <button class = 'button'>
                    <text style={{ textAnchor:'bottom', fontSize:'2em'}} fill = 'black' x = {"0%"} y = {"0"}>
                        Capstone - Vizualization
                    </text>
                </button>
                </a>
                <svg width = '100%' height = '1'>
                <line  x2="100%" y1="100%" y2="100%" stroke = "White"/>
                </svg>
            </div>


            <div>
                <Dropdown options={options} selectedValue={firstAttr} onSelectedValueChange={onFristAttrChange}/>
                <Dropdown options={options2} selectedValue={secondAttr} onSelectedValueChange={onSecondAttrChange}/>   
                <input key="slider" type='range' class = 'slider' list="tickmarks" min='0' max='3' value={year}  step='1' onChange={changeHandlerYear}/>
                    <datalist id="tickmarks">
                        <option value="0"></option>
                        <option value="1"></option>
                        <option value="2"></option>
                        <option value="3"></option>
                    </datalist>
                <input key="monthText" class='labelinput' type="text" value={'Year '+YEAR[year]} readOnly/>
            </div>

            <div> 
            <svg width ={150} height = {0} fill ={"black"}>
            </svg>
            <g transform={`translate(${200}, ${0})`}>
            <TreeMap width={WIDTH} height={HEIGHT} data = {data} first = {firstAttr} second = {secondAttr} selectedCell={selectedCell} setSelectedCell={setSelectedCell} />       
            </g>
            </div>
        </div>
        }

        ReactDOM.render( <Home_page/>, document.getElementById('root'));
    </script>

</body></html>
